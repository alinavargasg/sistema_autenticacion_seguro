<!-- src/app/auth/register/register.component.html -->
<div class="register-container">
  <h2>Registro Seguro</h2>
  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="registerForm.errors as formErrors" class="form-error">
      <div *ngIf="formErrors['registrationError']">
        {{ formErrors['registrationError'] }}
      </div>
      <div *ngIf="formErrors['passwordMismatch'] && !formErrors['registrationError']">
        Las contraseñas no coinciden
      </div>
    </div>
    <!-- Campo Username -->
    <div class="form-group" [class.invalid]="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
      <label for="username">Nombre de usuario:</label>
      <input 
        type="text" 
        id="username" 
        formControlName="username" 
        autocomplete="username"
        required>
      
      <div *ngIf="registerForm.get('username')?.errors as err" class="error-messages">
        <div *ngIf="err['required']">Nombre de usuario requerido</div>
        <div *ngIf="err['minlength']">Mínimo 3 caracteres</div>
        <div *ngIf="err['maxlength']">Máximo 20 caracteres</div>
        <div *ngIf="err['pattern']">Solo letras, números y _-</div>
      </div>
    </div>
    <!-- Campo Email -->
    <div class="form-group" [class.invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
      <label for="email">Email:</label>
      <input 
        type="email" 
        id="email" 
        formControlName="email" 
        autocomplete="email"
        required>
      
      <div *ngIf="registerForm.get('email')?.errors as err" class="error-messages">
        <div *ngIf="err['required']">Email requerido</div>
        <div *ngIf="err['invalidEmail']">Formato de email inválido</div>
        <div *ngIf="err['disposableEmail']">No se permiten emails temporales</div>
      </div>
    </div>

    <!-- Campo Password -->
    <div class="form-group" [class.invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
      <label for="password">Contraseña:</label>
      <input 
        type="password" 
        id="password" 
        formControlName="password" 
        autocomplete="new-password"
        required>
      
      <div *ngIf="registerForm.get('password')?.errors as err" class="error-messages">
        <div *ngIf="err['required']">Contraseña requerida</div>
        <div *ngIf="err['passwordStrength'] as strengthErr">
          <div *ngIf="strengthErr['missingUpperCase']">• 1 mayúscula</div>
          <div *ngIf="strengthErr['missingLowerCase']">• 1 minúscula</div>
          <div *ngIf="strengthErr['missingNumber']">• 1 número</div>
          <div *ngIf="strengthErr['missingSpecialChar']">• 1 carácter especial</div>
          <div *ngIf="strengthErr['minlength']">• Mínimo 8 caracteres</div>
        </div>
      </div>
      <div class="password-hint">
        La contraseña debe contener al menos 8 caracteres, incluyendo mayúsculas, minúsculas, números y símbolos
      </div>
    </div>

    <!-- Campo Confirm Password -->
    <div class="form-group" [class.invalid]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
      <label for="confirmPassword">Confirmar Contraseña:</label>
      <input 
        type="password" 
        id="confirmPassword" 
        formControlName="confirmPassword" 
        autocomplete="new-password"
        required>
      
      <div *ngIf="registerForm.hasError('passwordMismatch')" class="error-messages">
        Las contraseñas no coinciden
      </div>
    </div>

    <button 
      type="submit" 
      [disabled]="registerForm.invalid || loading"
      [class.loading]="loading">
      {{ loading ? 'Registrando...' : 'Crear Cuenta' }}
    </button>

    <div class="login-link">
      ¿Ya tienes cuenta? <a routerLink="/login">Inicia Sesión</a>
    </div>
  </form>
</div>